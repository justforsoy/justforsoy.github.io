[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this blog"
  },
  {
    "objectID": "posts/实验统计原理简介/index.html",
    "href": "posts/实验统计原理简介/index.html",
    "title": "实验统计简介",
    "section": "",
    "text": "两个现实中的问题 - 应用新版本发布7天后，新版用户留存率比老版本用户留存率提升10%，是否说明新版本取得了成功？ - 对商品涨价后，单月收入环比上月提升30%，同比去年提升10%，收入增长了么？赚了多少？\n虽然有了数据，我们仍然很难得到判断，因为我们关注的是因果（反事实）。而随机实验可以观测因果，所以要做实验"
  },
  {
    "objectID": "posts/实验统计原理简介/index.html#为什么要做实验",
    "href": "posts/实验统计原理简介/index.html#为什么要做实验",
    "title": "实验统计简介",
    "section": "",
    "text": "两个现实中的问题 - 应用新版本发布7天后，新版用户留存率比老版本用户留存率提升10%，是否说明新版本取得了成功？ - 对商品涨价后，单月收入环比上月提升30%，同比去年提升10%，收入增长了么？赚了多少？\n虽然有了数据，我们仍然很难得到判断，因为我们关注的是因果（反事实）。而随机实验可以观测因果，所以要做实验"
  },
  {
    "objectID": "posts/实验统计原理简介/index.html#实验结果可信么",
    "href": "posts/实验统计原理简介/index.html#实验结果可信么",
    "title": "实验统计简介",
    "section": "实验结果可信么？",
    "text": "实验结果可信么？\n我做了AB实验，实验组平均付费比对照组提升了1.1元，我的实验策略是否是有效的？\n由于现实中充满波动性，这个问题很难直接回答。但如果知道事件随机发生概率是多少，我们至少有一些把握\n以最简单的抛硬币为例：\n\nimport numpy as np\nimport pandas as pd\nfrom scipy import stats\nimport matplotlib.pyplot as plt\n\ndef binom_plot(n, obs, p=0.5):\n    dist = stats.binom(n, p)\n    x = np.arange(0, n+1)\n    pmf = dist.pmf(x)\n\n    thres = np.abs(np.abs(obs) - n/2)\n    plt.bar(x, pmf, color=['red' if np.abs(np.abs(i) - n/2) &gt;= thres else 'blue' for i in range(len(x))], alpha=0.5)\n    plt.show()\n\n\n一枚硬币扔了10次，其中6次正面，硬币是否均匀？\n如果硬币是均匀的，得到这种情况或者更极端情况的概率是多少：\\[P(投10次6次以上某一面 | 硬币均匀)\\]\n\n\nbinom_plot(10, 6)\n\n\n\n\n\n一枚硬币扔了100次，其中60次正面，它是否均匀？\n\\[P(投100次60次以上某一面 | 硬币均匀)\\]\n\n\nbinom_plot(100, 60)\n\n\n\n\n\n一枚硬币扔了1000次，其中600次正面，它是否均匀？\n\\[P(投1000次600次以上某一面 | 硬币均匀)\\]\n\n\nbinom_plot(1000, 600)\n\n\n\n\n实验也可以用类似的方法计算概率。其中最常用的是基于正态分布来计算：\n由于实验样本量一般较大，分组样本一般满足中心极限定律 &gt; 中心极限定律：\n&gt; 当大量随机变量相互独立时，它们的和或平均值的分布接近于正态分布。\n由此可得： \\[\\bar{X}_A \\sim N(E(X_A), \\sigma^2/cnt_A),\\ \\ \\  \\bar{X}_B \\sim N(E(X_B), \\sigma^2 / cnt_B)\\]\n若实验策略无效，实验组与对照组期望效果相同：\\(E(X_A) = E(X_B)\\)\n根据两个正态分母随机变量相减仍然服从正态分布的性质，则此时： \\[\\bar{X}_A - \\bar{X}_B \\sim N(0, \\sigma^2/cnt_A + \\sigma^2/cnt_B)\\]\n因此可以计算：在实验策略无效的情况下，得到这样的数据或者更极端数据的概率是多少？ —— 此概率越低，则实验策略有效概率越大"
  },
  {
    "objectID": "posts/实验统计原理简介/index.html#有了概率后如何决策",
    "href": "posts/实验统计原理简介/index.html#有了概率后如何决策",
    "title": "实验统计简介",
    "section": "有了概率后如何决策？",
    "text": "有了概率后如何决策？\n自然发生概率越低，实验策略有效概率越大。我们应该怎么基于这个数值进行决策？\n真相只有一个，但有两种可能，随之会导致两种决策错误：\n- 假阳性。实验策略无效，被误认为有效，类比于没得新冠检验阳性\n- 假阴性。实验策略有效，被误认为无效，类比于得了新冠检验阴性\n只要控制住这两种错误发生的概率，决策就是可靠且风险成承受的\n\n如何选取阈值要基于业务场景：\n- 互联网业务下，一般冒然变更风险大于收益，更看重于控制假阳性。最常见的阈值是：假阳性控制在0.05以内，假阴性控制在0.2以内；\n- 生命只有一次，医院检查中更看重控制假阴性。"
  },
  {
    "objectID": "posts/实验统计原理简介/index.html#假阳性如何控制",
    "href": "posts/实验统计原理简介/index.html#假阳性如何控制",
    "title": "实验统计简介",
    "section": "假阳性如何控制",
    "text": "假阳性如何控制\n由于没有效果时期望为0，即\\(E(\\bar{X}_A - \\bar{X}_B) = 0\\)，假阳性是很容易控制的\n假设我们对无效的实验做了100w次，并且根据假阳性0.05选择阈值，模拟可以得到下面的结果：\n\ndef h0_simulation(alpha = 0.05, trans = 0.5, ax=None, std_err = 1):\n    norm_sample = np.random.normal(0, std_err, 1000000)\n    if ax:\n        _, bins, patches = ax.hist(norm_sample, bins=1000, alpha=trans);\n    else:\n        _, bins, patches = plt.hist(norm_sample, bins=1000, alpha=trans);\n    for index, bin in enumerate(bins):\n        if index &gt;= len(patches):\n            break\n        if -np.abs(bin) &lt;= stats.norm.ppf(alpha / 2) * std_err:\n            patches[index].set_facecolor('red')\n        else:\n            patches[index].set_facecolor('blue')\n    return norm_sample\n\nnorm_sample = h0_simulation()\n\n\n\n\n对每个情况计算起随机产生的概率值（pValue），它的分布如下：\n\ndef p_calculator(norm_sample, alpha=0.05):\n    p_values = stats.norm.cdf(-np.abs(norm_sample)) * 2\n    # counts, bins = np.histogram(p_values, bins=100)\n    _, bins, patches = plt.hist(p_values, bins=100,alpha=0.5);\n    for i in range(int(100 * alpha + 1)):\n        patches[i].set_facecolor('red')\n    for i in range(int(100 * alpha + 1), len(patches)):\n        patches[i].set_facecolor('blue')\n    return p_values\n\np_values = p_calculator(norm_sample)\n\n\n\n\n由于实验无效，每次判断都是误判。\n统计我们决策错误的频率，会发现基本等于我们的控制目标0.05。 统计下频率：\n\n(p_values &lt;= 0.05).mean()\n\n0.049912"
  },
  {
    "objectID": "posts/实验统计原理简介/index.html#假阴性控制",
    "href": "posts/实验统计原理简介/index.html#假阴性控制",
    "title": "实验统计简介",
    "section": "假阴性控制",
    "text": "假阴性控制\n假设实验策略有效：\\(\\Delta = E(\\bar{X}_A - \\bar{X}_B)\\) 依据为控制假阳性所选取的阈值，范假阴性错误的几率是多少？\n\nh0_sample = h0_simulation(trans=0.4)\n\ndef h1_simulation(h0_sample, delta = 1, alpha = 0.05, ax=None, std_err=1):\n    h1_sample = h0_sample + delta\n    if ax:\n        _, bins, patches = ax.hist(h1_sample, bins=1000, alpha=0.5);\n    else:\n        _, bins, patches = plt.hist(h1_sample, bins=1000, alpha=0.5);\n    for index, bin in enumerate(bins):\n        if index &gt;= len(patches):\n            break\n        if bin &gt;= stats.norm.ppf(1 - alpha / 2) * std_err:\n            patches[index].set_facecolor('blue')\n        else:\n            patches[index].set_facecolor('red')\n\n    return h1_sample\n\nh1_simulation(h0_sample);\n\n\n\n\n要降低假阴性，我们可以怎么做？ - 尽量增大实验效果，增大两峰之间距离 —— 这与创意质量相关，实验无法影响\n\n_, axs = plt.subplots(1, 2, figsize=(12, 5), sharex=True)\n\nh0_sample = h0_simulation(trans=0.4, ax=axs[0])\nh1_simulation(h0_sample, ax=axs[0]);\n\nh0_sample = h0_simulation(trans=0.4, ax=axs[1])\nh1_simulation(h0_sample, delta=2 ,ax=axs[1]);\n\n\n\n\n\n降低假阳性的要求 —— 有时实验常常取0.1做为阈值\n\n\n_, axs = plt.subplots(1, 2, figsize=(12, 5), sharex=True)\n\nh0_sample = h0_simulation(trans=0.4, ax=axs[0])\nh1_simulation(h0_sample, ax=axs[0]);\n\nh0_sample = h0_simulation(trans=0.4, alpha=0.1, ax=axs[1])\nh1_simulation(h0_sample, alpha=0.1, ax=axs[1]);\n\n\n\n\n\n减少结果波动性（降低标准误），让分布变得更加「高瘦」—— 这是实验可以改善的\n\n\n_, axs = plt.subplots(1, 2, figsize=(12, 5), sharex=True)\n\nh0_sample = h0_simulation(trans=0.4, ax=axs[0])\nh1_simulation(h0_sample, ax=axs[0]);\n\nh0_sample = h0_simulation(trans=0.4, std_err=0.5, ax=axs[1])\nh1_simulation(h0_sample, std_err=0.5, ax=axs[1]);\n\n\n\n\n降低波动是控制检出率的关键。减少波动方法：\n- 增加样本量 —— 最常用方案，通过增加数量减小标准误\n- 处理离群值 —— 减少极值影响，通过降低样本方差减小标准误\n- 降噪算法 —— 控制变量法等"
  },
  {
    "objectID": "posts/实验统计原理简介/index.html#控制假阴性需要多少流量",
    "href": "posts/实验统计原理简介/index.html#控制假阴性需要多少流量",
    "title": "实验统计简介",
    "section": "控制假阴性需要多少流量?",
    "text": "控制假阴性需要多少流量?\n以上可知，假阴性与「真实效果」、「假阳性水平」、「样本方差」、「样本量」等因素相关，那么多大的样本量可以控制假阴性呢？\n\\[样本量 = f(真实效果,假阴性水平,假阳性水平, 流量分配比例, 样本方差)\\]\n其中入参中真实效果是未知的，导致无法直接计算，该如何解决？\n解决方案是引入最小检测效果（Minimum Detectable Effect）。基于此值计算样本量，可保证实验效果大于等于此值时「假阴性」符合标准\n控制假阴性是为了保证检出率，检出率定义为「功效（power）」：\\[功效 = 1 - 假阴性控制水平\\] 分析达到目标功效需要多少流量，称为功效分析\n以双尾等流量实验为例：\n\n定义假阳性控制目标为\\(\\alpha\\)，等流量双尾检验下，控制power需要满足条件： \\[ \\frac{MDE}{\\sqrt{(\\sigma^2 / n + \\sigma^2 / n)}} \\geq \\phi^{-1}(1 - \\alpha / 2) + \\phi^{-1}(power) \\]\n其中\\(\\phi^{-1}\\)是正态分布的逆累积分布函数，由上可推出：\\[n \\geq 2\\sigma ^{2} [ \\phi^{-1} (1 - \\alpha/2) + \\phi^{-1} (power )]^{2}/MDE^2\\]\n以mde = 1, alpha = 0.05, power = 0.8, var = 100计算需要样本量，按此样本量仿真100w次，结果如下：\n\nmde = 1\nalpha = 0.05\npower = 0.8\nvar = 100\n\nn = int(2 * var * (stats.norm.ppf(1 - alpha / 2) + stats.norm.ppf(power)) ** 2 / mde ** 2)\nstd_err = np.sqrt(var / n * 2)\n\nh0_sample = h0_simulation(trans=0.4, std_err=std_err)\nh1_sample = h1_simulation(h0_sample, std_err=std_err)\n\n\n\n\n\np_values = stats.norm.cdf(-np.abs(h1_sample) / std_err) * 2\nN, bins, patches = plt.hist(p_values, bins=100,alpha=0.5);\nfor i in range(11):\n    patches[i].set_facecolor('blue')\nfor i in range(11, len(patches)):\n    patches[i].set_facecolor('red')\n\n\n\n\n统计一下：\n\n(p_values &lt;= 0.05).mean()\n\n0.799763"
  },
  {
    "objectID": "posts/实验设计_如何选择样本量/index.html",
    "href": "posts/实验设计_如何选择样本量/index.html",
    "title": "A/B实验设计 —— 样本量计算",
    "section": "",
    "text": "本文介绍样本量对实验效果的影响，以及如何正确选择样本量。仅作为实验设计者可跳过最后数学推导过程，直接使用工具运算。"
  },
  {
    "objectID": "posts/实验设计_如何选择样本量/index.html#实验角度样本量越多越好",
    "href": "posts/实验设计_如何选择样本量/index.html#实验角度样本量越多越好",
    "title": "A/B实验设计 —— 样本量计算",
    "section": "实验角度，样本量越多越好",
    "text": "实验角度，样本量越多越好\n样本数量变多，实验则有了更多的“证据”，实验的“可靠性”也就越强。"
  },
  {
    "objectID": "posts/实验设计_如何选择样本量/index.html#业务角度样本量越少越好",
    "href": "posts/实验设计_如何选择样本量/index.html#业务角度样本量越少越好",
    "title": "A/B实验设计 —— 样本量计算",
    "section": "业务角度，样本量越少越好",
    "text": "业务角度，样本量越少越好\n样本量应该越少越好，因为：\n\n试错成本大。假设我们拿50%用的户来跑实验，但不幸的是，1周后结果表明实验组的总收入下降了20%。算下来，你的实验在一周内给整个公司带来了10%的损失。这个试错成本未免高了一些…\n其它风险增加。移动端例子，假设B方案崩溃率增长，1%流量我们可以从容处理，50%流量会对业务造成严重影响，甚至事故定责。\n流量有限。流量总数是确定的，同类型的实验不能重叠，实验流量更小，就可以同时运行更多的实验。"
  },
  {
    "objectID": "posts/实验设计_如何选择样本量/index.html#参数解释",
    "href": "posts/实验设计_如何选择样本量/index.html#参数解释",
    "title": "A/B实验设计 —— 样本量计算",
    "section": "参数解释",
    "text": "参数解释\n\nBaseline conversion rate：填入实验前估测到的转化率，可以通过旧数据统计作为估算。\nMinimum Detectable Effect：填入希望观测到的最小效果。填入实验的预期。\nStatistical power：1 - 假阴性概率。实验效果真实有效时，能被正确发现的概率。\nSignificance level：假阳性概率。实验实际没有效果时，被错误发现的概率。"
  },
  {
    "objectID": "posts/实验设计_如何选择样本量/index.html#单尾假设检验",
    "href": "posts/实验设计_如何选择样本量/index.html#单尾假设检验",
    "title": "A/B实验设计 —— 样本量计算",
    "section": "单尾假设检验",
    "text": "单尾假设检验\n\n定义θ = μ2 - μ1，图中对应假设可转换为： 原假设：θ = 0，此时对应红色曲线 备择假设：θ &gt; 0，此时对应绿色曲线\nμ1：方案A的期望值，不可改变。 μ2：方案B的期望值，不可改变。 $ x$：方案A的均值，会随机波动。 $ y$：方案B的均值，会随机波动。\n$ = ( &gt; C | = ) $ ，红色曲线下，红色面积占比。 $ = ( &lt;= C | &gt; ) $ 。 $ power = ( &gt; C | &gt; ) $ ，绿色曲线下，绿色面积占比。 MDE：根据期望效果取的值，会参与样本量计算 μ2 - μ1 &gt;= mde时，power大于等于预设值，实验容易显著。 μ2 - μ1 &lt; mde时，power小于预设，实验不容易显著。\n在$ &gt; C \\(中，C为预设常量，\\) x\\(、\\) y\\(通过实验获取无法控制，唯一可以改变的是\\)SD( y - x))$，样本量增大 -&gt; $ SD( y - x)) $减少 -&gt; 实验显著概率升高。\n计算过程： \\({SD( \\bar y - \\bar x)} = MDE / [ \\phi^{-1} (\\alpha) + \\phi^{-1} (power )]\\) ,\nx、y样本量同为n，标准差同为$$时， \\({SD( \\bar y - \\bar x)} = \\sqrt{2\\sigma ^{2}/ n}\\),\n易得\\(n = 2\\sigma ^{2} [ \\phi^{-1} (1- \\alpha) + \\phi^{-1} (power )]^{2}/MDE^{2}\\)"
  },
  {
    "objectID": "posts/实验设计_如何选择样本量/index.html#双尾假设检验",
    "href": "posts/实验设计_如何选择样本量/index.html#双尾假设检验",
    "title": "A/B实验设计 —— 样本量计算",
    "section": "双尾假设检验",
    "text": "双尾假设检验\n定义θ = μ2 - μ1，双尾情况下对应假设： 原假设：θ = 0； 备择假设：θ ≠ 0 ，等价于 θ &gt; 0 or θ &lt; 0。\n双尾假设检验一般是对称的，在此情况下有： 1. $= ( &gt; C1 | = ) + ( &lt; C2 | = ) $ 2. $( &gt; C1 | = ) = ( &lt; C2 | = ) $\n正态分布的概率密度函数特点为左右对称(钟形曲线)，由此可知： $ C1 &gt; 0, C2 &lt; 0, |C1| = |C2| $\n可以理解为一个α水平的双尾假设检验，等于两个α/2水平的单尾假设检验。 将α/2带入单尾计算公式，得到双尾检验需要的样本量为： \\(n = 2\\sigma ^{2} [ \\phi^{-1} (1 - \\alpha/2) + \\phi^{-1} (power )]^{2}/MDE^{2}\\)"
  },
  {
    "objectID": "posts/贝叶斯和多臂老虎机/index.html",
    "href": "posts/贝叶斯和多臂老虎机/index.html",
    "title": "贝叶斯和多臂老虎机",
    "section": "",
    "text": "多臂老虎机是一个在探索(exploration)和开发(exploitation)过程中寻找最高收益的问题。此类“实验”能力几乎已经成为了优秀实验平台的标配。\n本篇是阅读《A modern Bayesian look at the multi-armed bandit》后结合个人理解的学习总结。它总结了基于贝叶斯的随机概率匹配法和其它相关方法。"
  },
  {
    "objectID": "posts/贝叶斯和多臂老虎机/index.html#背景",
    "href": "posts/贝叶斯和多臂老虎机/index.html#背景",
    "title": "贝叶斯和多臂老虎机",
    "section": "",
    "text": "多臂老虎机是一个在探索(exploration)和开发(exploitation)过程中寻找最高收益的问题。此类“实验”能力几乎已经成为了优秀实验平台的标配。\n本篇是阅读《A modern Bayesian look at the multi-armed bandit》后结合个人理解的学习总结。它总结了基于贝叶斯的随机概率匹配法和其它相关方法。"
  },
  {
    "objectID": "posts/贝叶斯和多臂老虎机/index.html#随机概率匹配rpm",
    "href": "posts/贝叶斯和多臂老虎机/index.html#随机概率匹配rpm",
    "title": "贝叶斯和多臂老虎机",
    "section": "1. 随机概率匹配（RPM）",
    "text": "1. 随机概率匹配（RPM）\n定义\\(Y_t = (y_1, ..., y_t)\\)代表t时为止的奖励序列，\\(a_t\\)代表t时选择的臂，t时刻奖励\\(y_t \\sim f_{a_t}(y|\\theta)\\)，\\(\\theta\\)是一个未知向量。\n\\(y_t \\in (0, 1)\\)情况下两种例子：\n1. 伯努利老虎机，\\(\\theta = (\\theta_1, ...,\\theta_k)\\)，\\(f_{a_t}(y|\\theta)\\)参数为\\(\\theta_a\\)\n2. fractional factorial bandit（本文不关注）\n定义\\(\\mu_a(\\theta) = E(y_t | \\theta, a_t = a)\\)是\\(f_{a}(y|\\theta)\\)的期望值，最佳策略应该一直选择\\(\\mu_a(\\theta)\\)最大的臂。\n在伯努利分布下，\\(\\theta_a = \\mu_a(\\theta)\\)。\n定义\\(p(\\theta)\\)是\\(\\theta\\)的先验概率密度，此时以$p() \\(产生\\)\\(，\\)\\(产生y，则0时刻选择a正确概率： &gt;\\)w_{a0} = Pr(_a = max{_1,… })$ （1)\n定义\\(I_a(\\theta)\\)为指示函数，\\(\\mu_a = max\\{\\mu_1,...\\mu_k\\}\\)时\\(I_a(\\theta)=1\\)：\n&gt; \\(w_{a0} = E(I_a(\\theta)) = \\int I_a(\\theta) p(\\theta) d\\theta\\) （2）\n\n\n\n一个例子，先验可以Beta分布，两臂时为二元\n\n\n如果没有关于\\(\\theta\\)的先验，则先验视为各个\\(\\mu\\)是一样的，\\(w_{a0}\\)是均匀分布。\n观测到奖励情况后，通过贝叶斯方法进行更新，\\(p(\\theta | Y_t ) = \\frac{p(Y_t|\\theta)p(\\theta)}{p(Y_t)}\\)。t时刻：\n&gt; \\(p(\\theta | Y_t ) \\propto p(\\theta)\\prod _{\\tau = 1}^t f_{a_\\tau}(y|\\theta)\\) (3)\n则此时$w_{at} = Pr(_a = max{_1,…} | Y_t ) = E(I_a() | Y_t ) $ （4）\n随机概率匹配用\\(w_{at}\\)来分配a的t+1时观测值，通过一种自然平衡探索与开发的方式。\n\n1.1 概率分配计算\n如果\\(\\theta^{(1)},...,\\theta^{(G)}\\)是来自\\(p(\\theta|Y_t)\\)的独立抽样，则基于大数定理：\n&gt;\\(w_{at} = \\lim_{g\\rightarrow \\infty }\\frac{1}{G}\\sum^G_{g=1}I_a(\\theta^g).\\) （5）\n如果\\(f_a\\)是指数族，而且\\(p(\\theta)\\)是它的共轭分布，则可以独立的抽样\\(\\theta\\)，否则可以用马可夫相关的方法进行抽样模拟。\n\\(\\theta\\)的后验抽样足够对概率匹配进行支持。\n\n\n1.2 隐式分配\n（5）可以不用显式计算，从\\(p(\\theta|Y_t)\\)模拟 \\(\\theta^{t}\\)，并选择\\(a = argmax_a\\mu_a(\\theta^t)\\)\n\n\n1.3 探索(exploration)、开发(exploitation)和不确定性\n随机概率匹配自然的包含了不确定性，下图为两臂情况下的情况：\n\n在(a)中，错误选中概率为18%；在(b)中，错误选中概率为0.8%。\n这个例子说明，随着学习的进行，探索的占比会减少。"
  },
  {
    "objectID": "posts/贝叶斯和多臂老虎机/index.html#其它方法",
    "href": "posts/贝叶斯和多臂老虎机/index.html#其它方法",
    "title": "贝叶斯和多臂老虎机",
    "section": "2. 其它方法",
    "text": "2. 其它方法\n\n2.1 The Gittins index(基廷斯指数)\n此方法假设单臂未来的奖励会与一个几何分布有关：\\(\\sum_{t = 0} ^ {\\infty} \\gamma ^ty_t\\)，其中\\(0 \\leq \\gamma &lt; 1\\)\n基廷斯提供了一种计算各个臂价值的算法，得到的结果称为基廷斯指数。它在前提可保证时是最优方案。\n\n\n这部分的数学相关很复杂先跳过，简单了解可参考《算法之美》第二章相关部分。\n对基廷斯指数的三个问题：\n1. 不完全学习，可能最终收敛到次优解；\n2. 各臂的参数需要是固定的；\n3. 奖励减少结构必须是几何分布。\n\n\n2.2 UCB算法(Upper Confidence Bounds)\n计算每个手臂奖励均值及置信区间上限，然后选上限最高的手臂。\n值得注意的是，此上限并不是常见的置信区间算法，而且比较难计算。\n\n\n2.3 启发式策略\n\n2.3.1 平均分配\n次策略均匀的探索每个臂，直到其中一个臂奖励超过某个阈值，然后一直选择此臂。这种方法对\\(\\theta\\)探索效果很好，但是前期成本高，导致整体奖励效果较差。类似于先进行一轮随机实验评估效果，然后选择效果最好的方案。\n\n2.3.2 连胜就继续，输了就换其它\n至少好于随机选择……当最优秀的策略效果也没有特别好时，此方案会过度探索，导致效果很差。\n\n2.3.3 贪心策略\n简单的贪心策略效果很差，比较好的是deterministic probability matching做法。但是在批量更新场景，一个更新周期只能探索一种方案，所以前期会表现特别差。\n\n2.3.4 混合策略\n混合策略是贪心之外，强制进行一定比例的探索，比如Epsilon-greedy或Epsilon-decreasing。不过上两种方法的敏感度不够高，因此还可以参考Softmax learning方法。\n\n\n\n2.4 与概率匹配的对比\n概率匹配结合了2.3中的多种好处。"
  },
  {
    "objectID": "posts/贝叶斯和多臂老虎机/index.html#伯努利老虎机上使用不同策略的对比",
    "href": "posts/贝叶斯和多臂老虎机/index.html#伯努利老虎机上使用不同策略的对比",
    "title": "贝叶斯和多臂老虎机",
    "section": "3. 伯努利老虎机上使用不同策略的对比",
    "text": "3. 伯努利老虎机上使用不同策略的对比\n定义\\(\\theta = (\\theta_1, ...,\\theta_k)\\)，先验为\\(\\theta_a \\sim U(0, 1)\\)，它们之间相互独立。\n\\(Y_{at},N_{at}\\)分别代表t时刻a的累计成功次数和观测次数。\n则\\(\\theta = (\\theta_1, ...,\\theta_k)\\)的后验为：\n&gt;\\(p(\\theta|Y_t) =\\prod ^k_{a=1}Be(\\theta_a|Y_{at}+1,N_{at} - Y_{at} + 1)\\) (10)\n其中\\(B_e(\\theta|\\alpha, \\beta)\\)是贝塔分布。此时最佳概率为：\n&gt; \\(w_{at} = \\int_{0}^{1}Be(\\theta_a|Y_{at}+1,N_{at} - Y_{at} + 1)\\prod_{j\\neq a}Pr(\\theta_j &lt; \\theta_a | Y_{jt} + 1 - N_{jt} - Y_{jt} + 1)d\\theta_a\\) (11)\n验证主要关注regret，最佳选择\\(\\mu^*(\\theta) = max_a\\{\\mu_a(\\theta) \\}\\)，手臂a在t时刻的观测次数为\\(n_{at}\\)，则t时刻的regret为：\n&gt; $L_t = an{at}(^*() - _a()) $ (12)\n则T时段累计regret为\\(L = \\sum_{t= 1}^TL_t\\)。以下是一些模拟对比结果。\n\n3.1 批量更新场景\n\n3.1.1 RPM对比平均分配\n  \n从测试数据看RPM会比后者好得多。\n\n\n3.1.2 RPM对比贪心\n \n可发现在批量更新场景，两种贪心策略效果都是比RPM差的。\n\n\n\n3.2 实时更新场景\n\n平均效果来看，RPM效果最差，但是它的标准差最小，最优解命中率最高；参数为0.999的Gittins index平均效果最好，标准差较大，且最优解的命中率低于RPM。"
  },
  {
    "objectID": "posts/贝叶斯和多臂老虎机/index.html#后记",
    "href": "posts/贝叶斯和多臂老虎机/index.html#后记",
    "title": "贝叶斯和多臂老虎机",
    "section": "后记",
    "text": "后记\nRPM可以用来解决多臂老虎机问题，它基于后验抽样，易于实现、健壮性好，且在批量更新场景表现更佳。"
  },
  {
    "objectID": "posts/错误的共享对照/index.html",
    "href": "posts/错误的共享对照/index.html",
    "title": "实验间共享对照组缺陷及对策",
    "section": "",
    "text": "A/B实验目标是实现在线随机对照实验，因此需要满足「随机对照实验」的要求和前提。\n然而前支持的「对照组流量共享机制」违背了「随机对照实验」的基本要求。"
  },
  {
    "objectID": "posts/错误的共享对照/index.html#什么是随机对照实验随机",
    "href": "posts/错误的共享对照/index.html#什么是随机对照实验随机",
    "title": "实验间共享对照组缺陷及对策",
    "section": "1.什么是随机对照实验随机",
    "text": "1.什么是随机对照实验随机\n对照试验的基本方法是，将研究对象随机分组，对不同组实施不同的干预。\n在这种严格的条件下对照效果的不同。在研究对象数量足够的情况下，这种方法可以抵消已知和未知的混杂因素对各组的影响，被公认为是评价干预措施的金标准。"
  },
  {
    "objectID": "posts/错误的共享对照/index.html#在线随机的一般实现",
    "href": "posts/错误的共享对照/index.html#在线随机的一般实现",
    "title": "实验间共享对照组缺陷及对策",
    "section": "2.在线随机的一般实现",
    "text": "2.在线随机的一般实现\n根据随机实验定义我们要保证：统一群体随机分组，分组后用户属于哪个组稳定。 一般做法：用户标识 -&gt; 拼接salt，产生新字符串 -&gt; 哈希散列为数字 -&gt; 绝对值取余编号（分桶） -&gt; 桶编号范围分组 举例：假设一个实验将用户分100个桶，0 ~ 49号桶用户为对照组，50 ~ 99号桶用户为实验组"
  },
  {
    "objectID": "posts/错误的共享对照/index.html#共享对照流量",
    "href": "posts/错误的共享对照/index.html#共享对照流量",
    "title": "实验间共享对照组缺陷及对策",
    "section": "1.共享对照流量",
    "text": "1.共享对照流量\n设计思路比较朴素：既然对照组为基线，那么切一部分做对照，剩下的只用于实验，都与对照流量对比即可。 示例：  这样做有效利用了流量，但存在重大缺陷：持续迭代下，违背了「随机对照实验」的前提。"
  },
  {
    "objectID": "posts/错误的共享对照/index.html#共享对照缺陷",
    "href": "posts/错误的共享对照/index.html#共享对照缺陷",
    "title": "实验间共享对照组缺陷及对策",
    "section": "2.共享对照缺陷",
    "text": "2.共享对照缺陷\n实验持续迭代，当旧实验结束后，新实验会使用其释放的流量。由于习得性效应（残留效应）影响，此时两人群常常是不同质的。 示例： 上例的实验3结束后，实验4继承了实验3的流量做实验。「共享对照组」和「实验4」还是期望同质的人群么？ 由于释放人群表现 = 原表现 + 实验3效果 —— 除非「实验3」没任何效果才能满足！"
  },
  {
    "objectID": "posts/错误的共享对照/index.html#人群是否同质的谜题",
    "href": "posts/错误的共享对照/index.html#人群是否同质的谜题",
    "title": "实验间共享对照组缺陷及对策",
    "section": "3.人群是否同质的谜题",
    "text": "3.人群是否同质的谜题\n为什么讨论人群是否同质？其实是为了让实验正确决策。 - 随机对照实验下：实验组对照组期望同质，误判都是波动造成，通过统计模型可控。只要标准的统计推断即可保证「误判率」和「检出率」符合预设； - 共享对照实验下：实验组对照组期望同质不能保证，这让实验从科学变成了玄学；\n\n常见问题：实验AA组与对照组不一致，人群是不是不同质，效果可信么？ - 标准随机实验下：AA组与对照组期望同质，流量越大结果波动更小。因此建议流量合并当做对照组，再计算实验结果期望最优解。 - 共享对照实验下：无法解答，AA组和对照组都可能受残留效应影响。"
  },
  {
    "objectID": "posts/错误的共享对照/index.html#二次分流实验",
    "href": "posts/错误的共享对照/index.html#二次分流实验",
    "title": "实验间共享对照组缺陷及对策",
    "section": "1.二次分流实验",
    "text": "1.二次分流实验\n按实验分配流量（一个人群），实验内部再二次分配（随机分流）"
  },
  {
    "objectID": "posts/错误的共享对照/index.html#基于二次分流的共享对照",
    "href": "posts/错误的共享对照/index.html#基于二次分流的共享对照",
    "title": "实验间共享对照组缺陷及对策",
    "section": "2.基于二次分流的共享对照",
    "text": "2.基于二次分流的共享对照\n每次实验内部重新随机，做多实验组是合理的，此时对照组流量共享。 有共享流量分配最优解的研究《A Common Control Group - Optimising the Experiment Design to Maximise Sensitivity》"
  },
  {
    "objectID": "posts/错误的共享对照/index.html#增加流量的本质是什么",
    "href": "posts/错误的共享对照/index.html#增加流量的本质是什么",
    "title": "实验间共享对照组缺陷及对策",
    "section": "1.增加流量的本质是什么？",
    "text": "1.增加流量的本质是什么？\n流量越大结果越可信 = 样本越大均值波动越小 = 样本越大均值方差越小 = 样本越大标准误越小\n本质上我们是在追求更小的结果波动即更小的标准误。其样本量增加的收益是边际递减的。 \\[标准误 = \\sqrt{\\frac{样本方差}{对照组样本量} + \\frac{样本方差}{实验组样本量} } \\] 影响标准误的因素：样本方差、样本量"
  },
  {
    "objectID": "posts/错误的共享对照/index.html#增加样本量的收益",
    "href": "posts/错误的共享对照/index.html#增加样本量的收益",
    "title": "实验间共享对照组缺陷及对策",
    "section": "2.增加样本量的收益",
    "text": "2.增加样本量的收益\n通过案例估算： 假设一些用户其样本方差约35000，分配比例1:1， 标准差随样本量变化曲线为：  由上可知：其边际收益递减，大约几十万样本后就不会有特别快的下降。"
  },
  {
    "objectID": "posts/错误的共享对照/index.html#降低样本方差可能是更好的方法",
    "href": "posts/错误的共享对照/index.html#降低样本方差可能是更好的方法",
    "title": "实验间共享对照组缺陷及对策",
    "section": "3.降低样本方差可能是更好的方法",
    "text": "3.降低样本方差可能是更好的方法\n控制变量法、过滤离群点等降噪方法可以降低样本方差，而且常常对一些指标来说方差很容易就可以下降50%以上 样本方差从35000降低到5000收益："
  },
  {
    "objectID": "posts/实验设计_多重检验/index.html",
    "href": "posts/实验设计_多重检验/index.html",
    "title": "A/B实验设计 —— 多重检验",
    "section": "",
    "text": "本文介绍A/B实验中一个常见的错误——多重检验错误，它经常影响实验得到错误的结论。相关数学推导放在文末，跳过不影响理解。"
  },
  {
    "objectID": "posts/实验设计_多重检验/index.html#错误原因",
    "href": "posts/实验设计_多重检验/index.html#错误原因",
    "title": "A/B实验设计 —— 多重检验",
    "section": "错误原因",
    "text": "错误原因\n\n假设检验通建立在统计学原理上，假设检验并不能不产生误判，而是控制误判在我们预设范围之内，称为假阳性错误（α水平，一般选在5%）\n\n每次验证都会有错误的概率，因此只要检验次数增加，遇到至少一次错误的概率也会增加。"
  },
  {
    "objectID": "posts/实验设计_多重检验/index.html#案例分析",
    "href": "posts/实验设计_多重检验/index.html#案例分析",
    "title": "A/B实验设计 —— 多重检验",
    "section": "案例分析",
    "text": "案例分析\n上面的例子中，把各种颜色的糖作为不同实验组，与对照组进行对比。假设有20种糖，假阳性水平控制为5%，预期得到的显著结果为 20 * 5% = 1。我们很容易发现某种颜色糖果“似乎”与粉刺有关系，然而这是错误的。"
  },
  {
    "objectID": "posts/实验设计_多重检验/index.html#合理的设计实验",
    "href": "posts/实验设计_多重检验/index.html#合理的设计实验",
    "title": "A/B实验设计 —— 多重检验",
    "section": "1. 合理的设计实验",
    "text": "1. 合理的设计实验\n设计实验前充分分析、调查，针对相关可能最大的因素进行实验，避免大量无用因素干扰得到错误结论。\n宗旨：尽量减少检验次数，降低犯错概率\n\n控制实验组尽可能少\n不同颜色软糖对粉刺的影响不应该有区别，因此只需要设计一组实验组。\n\n控制指标尽可能少\n我们可以同时检验软糖实验组对粉刺、喉咙痛、高血压…再夸张些，婚姻幸福度、孩子情况…检验的指标越多，得到假阳性结果的可能性同样上升（吃软糖与生女孩相关明显是荒谬的）。"
  },
  {
    "objectID": "posts/实验设计_多重检验/index.html#多次检验校正",
    "href": "posts/实验设计_多重检验/index.html#多次检验校正",
    "title": "A/B实验设计 —— 多重检验",
    "section": "2. 多次检验校正",
    "text": "2. 多次检验校正\n统计学领域已经发明了一些方法来对多次检验进行校正。主要思想是检验次数越多，就要对显著采用更严格的限制，但是都会导致power的损失，降低发现率。\n常用方式：Bonferroni correction、Holm–Bonferroni method。\n缺点：会导致power有所损失（特别是检验结果不独立时）。"
  },
  {
    "objectID": "posts/实验设计_多重检验/index.html#实验后分析",
    "href": "posts/实验设计_多重检验/index.html#实验后分析",
    "title": "A/B实验设计 —— 多重检验",
    "section": "3. 实验后分析",
    "text": "3. 实验后分析\n显著不等于一定正确。实验后需要对实验进行因果分析，结果需要可合理解释（不是编故事）。如果采用了多次检验校正，还需要考虑假阴性问题。"
  },
  {
    "objectID": "posts/实验设计_多重检验/index.html#符号定义",
    "href": "posts/实验设计_多重检验/index.html#符号定义",
    "title": "A/B实验设计 —— 多重检验",
    "section": "符号定义",
    "text": "符号定义\n m：总检验假设数\nm0：零假设正确的数量，我们无法得知\nm - m0：备择假设正确的数量\nV：假阳性结论数量\nS：真阳性数量\nT：假阴性数量\nU：真阴性数量\nR = V + S：拒绝零假设数量\n在m个假设检验中，m0个零假设为真，R是观察到的显著情况的随机变量，S、T、U、V都是不可观测的随机变量。"
  },
  {
    "objectID": "posts/实验设计_多重检验/index.html#相关推导",
    "href": "posts/实验设计_多重检验/index.html#相关推导",
    "title": "A/B实验设计 —— 多重检验",
    "section": "相关推导",
    "text": "相关推导\n如果m次检验是独立的，则产生假阳性的概率为:\n\\(\\alpha = 1 - ( 1 - \\alpha_{sub} )^{m}\\)\n如果检验不是独立的，仍然有：\n\\(\\alpha \\leq m * \\alpha_{sub}\\)"
  },
  {
    "objectID": "posts/实验设计_多重检验/index.html#bonferroni-correction",
    "href": "posts/实验设计_多重检验/index.html#bonferroni-correction",
    "title": "A/B实验设计 —— 多重检验",
    "section": "Bonferroni correction",
    "text": "Bonferroni correction\n方法：将每次检验的显著性从$ {sub}\\(调整为\\){newSub}$ = $ _{sub} / m$\n原理：根据上述不等式，则有\\(\\alpha \\leq m * \\alpha_{newSub} = \\alpha_{sub}\\) ，因此可以有效将假阳性水平控制在预设之内。\n优点：简单好理解。\n缺点：由于条件过于严格，假阴性错误率升高。"
  },
  {
    "objectID": "posts/实验设计_多重检验/index.html#holmbonferroni-method",
    "href": "posts/实验设计_多重检验/index.html#holmbonferroni-method",
    "title": "A/B实验设计 —— 多重检验",
    "section": "Holm–Bonferroni method",
    "text": "Holm–Bonferroni method\n方法：将得到的P值从小到大排序记序号为i(1 ~ m)，从i = 1开始与 \\(\\alpha / (m - i + 1)\\)比较，小于就继续比较下一个。直到找出不符合条件的i(也可能不存在) ，i之前的全部认为显著，i及i之后的全部不显著。 原理： &gt;1. 将p值从大到小排序；\n&gt;2. 我们只需要关心P值最小的第一个零假设为真的情况：如果被拒绝，产生假阳性；否则，比较过程停止，未产生假阳性；\n&gt;3. 设第一个零假设为真的比较序号为h，则共有h - 1次正确的拒绝零假设，则：\n本次拒绝零假设条件为\\(\\alpha / (m - h + 1)\\) (a);\n\\(h - 1 \\leq m - m0\\)（正确拒绝的次数，一定小于等于备择假设为真的次数）；\n推出\\(\\frac{1}{m - h + 1} \\leq \\frac{1}{m_0}\\) (b)；\n不等式两边乘以\\(\\alpha\\)，得到(a)$ \\(。 &gt;4. 根据相关推导中结论，单次比较\\)_{sub} \\(，又\\)m_0$种等可能情况，则:\n\\(\\alpha_{_{real}} \\leq m_0 * \\alpha_{sub} \\leq \\alpha\\)\n优点：相对简单，假阴性错误率小于等于Bonferroni correction。\n缺点：假阴性依然高于预设（尤其是在检验结果相关情况下）。"
  },
  {
    "objectID": "posts/破产问题和简单序贯检验/index.html",
    "href": "posts/破产问题和简单序贯检验/index.html",
    "title": "赌徒破产和序贯检验",
    "section": "",
    "text": "本文是对Simple Sequential A/B Testing的解读。 该方法归属序贯检测类，可以用于伯努利分布场景，随着抽样持续进行，判断接受零假设或备择假设（关于序贯检测）。"
  },
  {
    "objectID": "posts/破产问题和简单序贯检验/index.html#概率计算",
    "href": "posts/破产问题和简单序贯检验/index.html#概率计算",
    "title": "赌徒破产和序贯检验",
    "section": "概率计算",
    "text": "概率计算\n使用\\(R_{n,d}\\)来表示赌徒起始d元在第n轮输光的概率。 总局：n，输：(n + d) / 2，胜：(n - d) / 2。\n\n赌场可以借钱给赌徒的情况，此时为简单的排列组合关系。\n&gt;\\(R_{n,d} = \\binom{n}{(n + d)/ 2} * 2^{-n}\\)\n赌场不肯借钱给赌徒情况。\n&gt; \\(R_{n,d} = \\frac{d}{n}\\binom{n}{(n + d)/ 2} * 2^{-n}\\)\n\n这是简单序贯检测的基础，将在下面推导。"
  },
  {
    "objectID": "posts/破产问题和简单序贯检验/index.html#随机游走和选举定理",
    "href": "posts/破产问题和简单序贯检验/index.html#随机游走和选举定理",
    "title": "赌徒破产和序贯检验",
    "section": "随机游走和选举定理",
    "text": "随机游走和选举定理\n在此对第二种情况进行计算。\n\n取纵坐标为钱，横坐标为赌博轮次，则过程为一维随机游走。举例：\n\n\n\n此时从A出发到K，满足条件路径数（中途不与0轴接触），等于从K出发到A的路径数。场景转换为从0开始，到d结束。\n\n\n\n在满足中途不触碰0轴条件，第一步必须为正。则从J到A路径数等于从A到K路径数。\n\n如图所示，每一条从J到第一个接触横轴的点的路径，总有一条从K出发到相同点的映射路径，后续都走相同路径。因此J到A经过横轴路径数等于K到A的路径数。\n设从0出发，有p步向上，q步向下。根据3，满足不触碰横轴概率为： $ ( {p - 1} - ) / = $\n\n此公式被称为选举定理。 &gt;将\\(p + q = n, p - q = d\\)带入，原问题最终结果为\\(\\frac{d}{n}\\binom{n}{(n + d)/ 2} * 2^ {-n}\\)"
  },
  {
    "objectID": "posts/破产问题和简单序贯检验/index.html#与赌徒破产问题的关系",
    "href": "posts/破产问题和简单序贯检验/index.html#与赌徒破产问题的关系",
    "title": "赌徒破产和序贯检验",
    "section": "与赌徒破产问题的关系",
    "text": "与赌徒破产问题的关系\n均等流量的转化率型ab测试场景中，实验组、对照组随着时间推移，都会产生转化。在零假设下，下一次转化发生在实验组或对照组的概率是相等的。因此可以转换为赌徒破产问题。\n每轮次：下一次转化发生； 每轮获胜者：下一次转化所在的组； 破产的轮次n：实验组、对照组转换数之和； 赌徒初始筹码d：因为转换数积累是从零开始的，不能直接套用。可以认为赌徒初始资本为0，输到-d时破产。"
  },
  {
    "objectID": "posts/破产问题和简单序贯检验/index.html#假设检验设计",
    "href": "posts/破产问题和简单序贯检验/index.html#假设检验设计",
    "title": "赌徒破产和序贯检验",
    "section": "假设检验设计",
    "text": "假设检验设计\n以下仅介绍单尾情况，双尾的扩展请参考原文。\n\n原假设\n零假设(H0)：实验组转化率等于对照组转化率（对应未破产情况）； 备择假设(H1)：实验组转化率小于对照组转换率（对应破产情况）。\n\n\n假阳性控制(alpha)\n在零假设假设下，第n轮赌徒破产概率为： \\(R_{n,d} = \\frac{d}{n}\\binom{n}{(n + d)/ 2} * 2^{-n}\\) 在N轮及N轮之前，赌徒破产概率为：\\(\\sum_{n = 1} ^{N}R_{n,d}\\) 利用此公式控制假阳性，通过控N和d的选取，可以控制假阳性水平。\n\n\n假阴性控制(beta)\n控制假阴性，需要预设期望的最小观测效果（mde，此处选相对效果）。当实际提升效果等于MDE时，假阴性概率等于预设值。 在备择假设下，当实验组提升了mde时，下一次转化发生在实验概率为\\(P_t = \\frac {1 + mde} {2 + mde}\\)，对照组概率为\\(P_c = \\frac{1}{2 + mde}\\)。 第n轮破产概率：\\(R_{n,d} = \\frac{d}{n}\\binom{n}{(n + d)/ 2} * P_c ^ {(n - d) / 2}* P_t^{(n + d) / 2}\\)。 在N轮及N轮之前，赌徒破产概率为：\\(\\sum_{n = 1} ^{N}R_{n,d}\\) 取上面的概率为功效(power)，通过次N和d的选取，可以控制假阴性水平。\n\n\n选择结束条件\n联立上述不等式，使N和d满足： &gt; \\(\\sum_{n = 1}^N \\frac{d}{n}\\binom{n}{(n + d)/ 2} * 2^{-n} &lt; \\alpha\\) \\(\\sum_{n = 1}^N \\frac{d}{n}\\binom{n}{(n + d)/ 2} * P_c^{(n - d) / 2}* P_t^{(n + d) / 2} &gt; 1 - \\beta\\)\n不等式很难直接求解，可通过计算机遍历可能的N和d，找到合适的值。\n\n\n具体流程\n\n实验开始，实验组、对照组从0开始计数；\n每有一个转化，对应的组计数+1，并进行判断；\n对照转化数 - 实验组转化数 &gt;= d，接受备择假设；\n对照转化数 + 实验组转化数 = N，接受原假设。"
  },
  {
    "objectID": "posts/破产问题和简单序贯检验/index.html#优点",
    "href": "posts/破产问题和简单序贯检验/index.html#优点",
    "title": "赌徒破产和序贯检验",
    "section": "优点",
    "text": "优点\n\n基于弱假设，易于理解和证明；\n过程易于操作；\n在低转换率时，需要样本量小于固定水平检验需要的样本量；\n不存在“偷看”问题。"
  },
  {
    "objectID": "posts/破产问题和简单序贯检验/index.html#缺点",
    "href": "posts/破产问题和简单序贯检验/index.html#缺点",
    "title": "赌徒破产和序贯检验",
    "section": "缺点",
    "text": "缺点\n\n只适用于近似伯努利分布场景；\n结束条件难以直接计算，需要通过计算机遍历查找；\n在高转化率时，需求样本量大于固定水平检验需要的样本量；\n无法直接给出置信区间和P值。"
  },
  {
    "objectID": "posts/实验设计_偷看问题/index.html",
    "href": "posts/实验设计_偷看问题/index.html",
    "title": "A/B实验设计 —— 偷看问题",
    "section": "",
    "text": "偷看是ab测试中最常遇到的问题，本文将说明影响，分析用户为什么偷看，探讨如何应对。"
  },
  {
    "objectID": "posts/实验设计_偷看问题/index.html#a.-我们有偷看的需求",
    "href": "posts/实验设计_偷看问题/index.html#a.-我们有偷看的需求",
    "title": "A/B实验设计 —— 偷看问题",
    "section": "a. 我们有偷看的需求",
    "text": "a. 我们有偷看的需求\n\n及时止损，尽早结束失败（有害）的实验；\n\n扩大胜利成果，尽早发现成功的实验。"
  },
  {
    "objectID": "posts/实验设计_偷看问题/index.html#b.-存在允许偷看的客观条件",
    "href": "posts/实验设计_偷看问题/index.html#b.-存在允许偷看的客观条件",
    "title": "A/B实验设计 —— 偷看问题",
    "section": "b. 存在允许偷看的客观条件",
    "text": "b. 存在允许偷看的客观条件\n固定水平检验产生在大约100年前。我们来看下当年与现代的对比。\n100年前：\n- 数据成本高、收集缓慢\n著名的统计学家费希尔，使用假设检验对农业进行研究。作物的生长周期是很难改变的，无法预知结果…数据的采集、计算依赖人力。\n- 对操作者要求高\n实验者是经过训练的专家。\n现在：\n- 数据及时、廉价 科技降低了数据获取的成本，可以研究更精细的事物。互联网业采集、分析用户行为已经越来越成熟。 - 人人都可以是操作者 在成熟ab测试平台上，实验者可以轻松进行实验，也更容易在实验分析中犯错。"
  },
  {
    "objectID": "posts/实验设计_偷看问题/index.html#c.-实验平台模板不适合",
    "href": "posts/实验设计_偷看问题/index.html#c.-实验平台模板不适合",
    "title": "A/B实验设计 —— 偷看问题",
    "section": "c. 实验平台模板不适合",
    "text": "c. 实验平台模板不适合\n实验平台提供了固定的模板，以及在此模板下的终止条件，常见为限定实验周期、分析单位等，并以此得到结束条件。\n固化的模板不能通用于所有的实验，因此用户自己判断是否停止也不足为奇。\n平台需要增强实验个性化的能力。"
  },
  {
    "objectID": "posts/实验设计_偷看问题/index.html#不偷看",
    "href": "posts/实验设计_偷看问题/index.html#不偷看",
    "title": "A/B实验设计 —— 偷看问题",
    "section": "不偷看",
    "text": "不偷看\n这是最简单可靠的方案，但是经常很困难。参考以下场景：\n\n大佬：B方案显著正面了，上线了吧\n小弟：不行，我们还需要再等三天\n大佬：B方案负面显著了，快回滚\n小弟：还需要等三天……\n大佬：这个方案竟然不显著？在跑几天！\n小弟：不行，我们已经达到停止条件了"
  },
  {
    "objectID": "posts/实验设计_偷看问题/index.html#非固定水平检验",
    "href": "posts/实验设计_偷看问题/index.html#非固定水平检验",
    "title": "A/B实验设计 —— 偷看问题",
    "section": "非固定水平检验",
    "text": "非固定水平检验\n比如贯序检验系列方法，他们一般掌握成本更高，过程更复杂。由于结束条件改变了，并不一定会比固定水平检验更快结束。 Optimizely采用了这种方案，过程中用户可以偷看，每次平台提供可靠的P值与置信区间，整个过程后假阳性依然控制在预定水平。"
  },
  {
    "objectID": "posts/实验设计_偷看问题/index.html#使用非检验方法",
    "href": "posts/实验设计_偷看问题/index.html#使用非检验方法",
    "title": "A/B实验设计 —— 偷看问题",
    "section": "使用非检验方法",
    "text": "使用非检验方法\n有时我们不需要解释，只是希望得到最好的组合，这种问题为multi-armed bandit problem，已经有很多相关的研究。"
  },
  {
    "objectID": "posts/双样本客观贝叶斯/index.html",
    "href": "posts/双样本客观贝叶斯/index.html",
    "title": "双样本客观贝叶斯检验",
    "section": "",
    "text": "本文是对《Objective Bayesian Two Sample Hypothesis Testing for Online Controlled Experiments》的理解。"
  },
  {
    "objectID": "posts/双样本客观贝叶斯/index.html#定义",
    "href": "posts/双样本客观贝叶斯/index.html#定义",
    "title": "双样本客观贝叶斯检验",
    "section": "定义",
    "text": "定义\n$Z = $\n\\(N_E = \\frac{1}{1/N_T + 1/N_C}\\)\n\\(\\sigma^2 / N_E = \\sigma^2_T/N_T + \\sigma^2_C/N_C\\)\n\\(\\delta = \\Delta / \\sigma\\)\n\\(\\mu = E(\\delta)\\)\n则根据定义：\n$ N ( , 1 / N_E ) $\n\\(Z = \\frac{\\delta} {\\sqrt{1 / N_E}}\\)"
  },
  {
    "objectID": "posts/双样本客观贝叶斯/index.html#模型设计",
    "href": "posts/双样本客观贝叶斯/index.html#模型设计",
    "title": "双样本客观贝叶斯检验",
    "section": "模型设计",
    "text": "模型设计\n\\(H0:\\mu = 0\\)\n\\(H1:\\mu \\sim \\pi(\\mu)\\)\n\\(H1\\)为真概率为\\(p\\)，则\\(H0\\)概率为\\(1 - p\\)\n\\(P(\\delta|H_1) = \\int _Mf_\\mu(\\delta)\\pi(\\mu)d\\mu\\)\n关于\\(\\mu\\)的先验\\(\\pi\\)，采用一个简单的正态分布模型：\\(\\pi(\\mu) =N(0, V^2)\\)，\n&gt;1.\\(\\delta = \\mu + \\sqrt{1 / N_E} * \\varepsilon, \\varepsilon \\sim N(0, 1)\\)\n&gt;2.\\(\\mu =0 + V * \\varepsilon_0, \\varepsilon_0 \\sim N(0,1) \\$ &gt;则\\)= * + V * _0, _0 N(0,1) , N(0, 1)$\n可求得\\(E(\\delta) = 0, Var(\\delta) = 1/N_{E} + V^2\\),\n则\\((\\delta|\\pi, N_E) \\sim N(0, 1/N_{E} + V^2)\\)"
  },
  {
    "objectID": "posts/双样本客观贝叶斯/index.html#先验概率与v的选取",
    "href": "posts/双样本客观贝叶斯/index.html#先验概率与v的选取",
    "title": "双样本客观贝叶斯检验",
    "section": "先验概率与V的选取",
    "text": "先验概率与V的选取\n我们并不知道历史实验中，哪些\\(\\delta_i\\)属于\\(H0\\)哪些属于\\(H1\\)。\n如何根据历史实验求解先验？这种依赖不可观察的隐性变量的概率模型，可以使用最大期望算法：\n\n\\(\\frac{P(H1)}{P(H0)} * \\frac{P(\\Delta|H1)}{P(\\Delta|H0)} = \\frac{p}{1 - p} * \\frac{\\phi (\\delta_i; 0, 1/N_{Ei} + V^2)}{\\phi (\\delta_i; 0, 1/N_{Ei})}\\)\n求得\\(P_i = P(H1|\\delta_i;p,V)\\)\n\n将\\(p\\)设置为1中得到的\\(P_i\\)的均值\n\n\\(V^2 =\\frac{\\sum{var(\\delta_i) * P_i}}{\\sum{P_i}} - \\frac{\\sum{1 / N_{Ei} * P_i}}{\\sum{P_i}} = \\frac{\\sum{\\delta_i^2 * P_i}}{\\sum{P_i}} - \\frac{\\sum{1 / N_{Ei} * P_i}}{\\sum{P_i}}\\)\n\n重复上述步骤直到\\(p\\)与\\(V\\)收敛，作为它们的最大似然估计。"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "学习 & 工作 & 思考",
    "section": "",
    "text": "贝叶斯和多臂老虎机\n\n\n\n\n\n\n\n贝叶斯\n\n\n多臂老虎机\n\n\n旧文迁移\n\n\n\n\n\n\n\n\n\n\n\nNov 26, 2023\n\n\n\n\n\n\n  \n\n\n\n\n双样本客观贝叶斯检验\n\n\n\n\n\n\n\nAB\n\n\n贝叶斯\n\n\n旧文迁移\n\n\n\n\n\n\n\n\n\n\n\nNov 26, 2023\n\n\n\n\n\n\n  \n\n\n\n\nA/B实验设计 —— 多重检验\n\n\n\n\n\n\n\nAB\n\n\n实验设计\n\n\n多重检验\n\n\n旧文迁移\n\n\n\n\n\n\n\n\n\n\n\nNov 25, 2023\n\n\n\n\n\n\n  \n\n\n\n\nA/B实验设计 —— 偷看问题\n\n\n\n\n\n\n\nAB\n\n\n实验设计\n\n\n旧文迁移\n\n\n\n\n\n\n\n\n\n\n\nNov 25, 2023\n\n\n\n\n\n\n  \n\n\n\n\nA/B实验设计 —— 样本量计算\n\n\n\n\n\n\n\nAB\n\n\n实验设计\n\n\n旧文迁移\n\n\n\n\n\n\n\n\n\n\n\nNov 13, 2023\n\n\n\n\n\n\n  \n\n\n\n\n赌徒破产和序贯检验\n\n\n\n\n\n\n\nAB\n\n\n序贯检验\n\n\n赌徒破产\n\n\n随机游走\n\n\n\n\n\n\n\n\n\n\n\nNov 12, 2023\n\n\n\n\n\n\n  \n\n\n\n\n实验间共享对照组缺陷及对策\n\n\n\n\n\n\n\nAB\n\n\n\n\n\n\n\n\n\n\n\nNov 11, 2023\n\n\n\n\n\n\n  \n\n\n\n\n实验统计简介\n\n\n\n\n\n\n\nAB\n\n\n\n\n\n\n\n\n\n\n\nNov 11, 2023\n\n\n\n\n\n\nNo matching items"
  }
]